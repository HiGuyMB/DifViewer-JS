<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DIF Viewer</title>

    <!-- Make it pretty! -->
    <link rel="stylesheet" href="styles/styles.css">

    <!-- Pretty useful math library -->
    <script src="lib/gl-matrix-min.js"></script>
    <script src="lib/ammo.js"></script>
    <script src="scripts/convert.js"></script>

    <!-- Javascript GL classes -->
    <script src="scripts/shader.js"></script>
    <script src="scripts/vbo.js"></script>
    <script src="scripts/texture.js"></script>
    <script src="scripts/material.js"></script>
	<script src="scripts/materialMap.js"></script>
	<script src="scripts/skySphere.js"></script>

    <!-- Whoooo -->
    <script src="scripts/physics.js"></script>
    <script src="scripts/sphere.js"></script>

	<!-- DIF library -->
	<script src="scripts/dif/dif.js"></script>
	<script src="scripts/dif/reader.js"></script>
	<script src="scripts/dif/interior.js"></script>
	<script src="scripts/dif/math.js"></script>

    <!-- Main GL and rendering -->
    <script src="scripts/gl.js"></script>

    <!-- Window, cursor, and keyboard control -->
    <script src="scripts/input.js"></script>
</head>
<body>
<div id="input">
	<label for="picker">DIF File: <input type="file" id="picker"></label><br>
	<div id="difInfo"></div>
	<label for="physics">Physics (test): <input type="checkbox" id="physics"></label><br>
	<label for="shaders">Shaders (MBU Noise Tiles / Ice): <input type="checkbox" id="shaders" checked></label><br>
	<input type="submit" value="Load" id="load">
</div>
<div id="fpsMeter"></div>

<!-- Don't start up the GL stuff until we've loaded the body -->
<script type="text/javascript">
	function handleDifSelect(e) {
		var files = e.target.files;
		var file = files[0];

		var reader = new FileReader();
		reader.onload = function(e) {
			var raw = e.target.result;
			var rawBytes = new Uint8Array(raw);

			var dif = new DIF(rawBytes);
			model = dif.getModel(0);

			var infoDiv = document.getElementById("difInfo");
			infoDiv.innerHTML = "Loaded " + (model.faces.length / 14) + " triangles.";
		};
		reader.readAsArrayBuffer(file);
	}

	document.getElementById("picker").addEventListener("change", handleDifSelect, false);

	document.getElementById("load").addEventListener("click", function(e) {
		physics = document.getElementById("physics").checked;
		customShaders = document.getElementById("shaders").checked;

		initGL();
	}, false);
</script>
</body>
</html>